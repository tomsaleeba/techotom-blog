---
layout: post
title: 'tycho-p2-director-plugin "Error packing product:  isn''t a directory" problem'
date: 2014-10-27 00:00:58.000000000 +10:30
type: post
published: true
status: publish
categories:
- IT
- Software Development
tags: []
meta:
  _edit_last: '29818343'
  geo_public: '0'
  _publicize_pending: '1'
author: Tom Saleeba
---
<h1>The problem</h1>
<p>You're trying to build an Eclipse update site project, specifically <code>&lt;packaging&gt;eclipse-repository&lt;/packaging&gt;</code>, with maven and you're getting the following error:</p>
<pre style="white-space:pre;overflow-x:auto;">[INFO] --- tycho-p2-director-plugin:0.21.0:archive-products (default) @ YourProject.UpdateSite ---
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 1:00.627s
[INFO] Finished at: Mon Oct 27 09:56:51 CST 2014
[INFO] Final Memory: 84M/764M
[INFO] ------------------------------------------------------------------------
<span style="color:#ff0000;"><strong>[ERROR] Failed to execute goal org.eclipse.tycho:tycho-p2-director-plugin:0.21.0:archive-products (default) on project YourProject.UpdateSite: Error packing product: /path/to/YourProject.UpdateSite/target/products/your.product/linux/gtk/x86 isn't a directory. -&gt; [Help 1]</strong></span>
[ERROR]
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR]
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException</pre>
<p>This error message is specific to this environment block that you would have defined in your POM:</p>
<pre>&lt;environment&gt;
  &lt;os&gt;linux&lt;/os&gt;
  &lt;ws&gt;gtk&lt;/ws&gt;
  &lt;arch&gt;x86&lt;/arch&gt;
&lt;/environment&gt;
</pre>
<p>For the sake of making this post easier to find for people Googling for error messages, you might get one of the following error messages for other common environments:</p>
<pre style="white-space:pre;overflow-x:auto;">[ERROR] Failed to execute goal org.eclipse.tycho:tycho-p2-director-plugin:0.21.0:archive-products (default) on project YourProject.UpdateSite: Error packing product: /path/to/YourProject.UpdateSite/target/products/your.product/linux/gtk/x86_64 isn't a directory. -&gt; [Help 1]
[ERROR] Failed to execute goal org.eclipse.tycho:tycho-p2-director-plugin:0.21.0:archive-products (default) on project YourProject.UpdateSite: Error packing product: /path/to/YourProject.UpdateSite/target/products/your.product/win32/win32/x86 isn't a directory. -&gt; [Help 1]
[ERROR] Failed to execute goal org.eclipse.tycho:tycho-p2-director-plugin:0.21.0:archive-products (default) on project YourProject.UpdateSite: Error packing product: /path/to/YourProject.UpdateSite/target/products/your.product/win32/win32/x86_64 isn't a directory. -&gt; [Help 1]
[ERROR] Failed to execute goal org.eclipse.tycho:tycho-p2-director-plugin:0.21.0:archive-products (default) on project YourProject.UpdateSite: Error packing product: /path/to/YourProject.UpdateSite/target/products/your.product/macosx/cocoa/x86_64 isn't a directory. -&gt; [Help 1]
</pre>
<h1>The fix</h1>
<p>For me, the problem was the order that I executed the goals in the maven build. They get executed in the order that you define them so when I wrote:</p>
<pre>&lt;build&gt;
  ...
  &lt;plugins&gt;
	...
	&lt;plugin&gt;
	  &lt;groupId&gt;org.eclipse.tycho&lt;/groupId&gt;
	  &lt;artifactId&gt;tycho-p2-director-plugin&lt;/artifactId&gt;
	  &lt;version&gt;${tycho-version}&lt;/version&gt;
	  &lt;executions&gt;
		&lt;execution&gt;
		  &lt;phase&gt;package&lt;/phase&gt;
		  &lt;!-- Incorrect goal order --&gt;
		  &lt;goals&gt;
			<span style="color:#ff0000;"><strong>&lt;goal&gt;archive-products&lt;/goal&gt;
			&lt;goal&gt;materialize-products&lt;/goal&gt;</strong></span>
		  &lt;/goals&gt;
		&lt;/execution&gt;
	  &lt;/executions&gt;
	  &lt;configuration&gt;
		&lt;products&gt;
		  &lt;product&gt;
			&lt;id&gt;your.product&lt;/id&gt;
		  &lt;/product&gt;
		&lt;/products&gt;
	  &lt;/configuration&gt;
	&lt;/plugin&gt;
	...
  &lt;/plugins&gt;
  ...
&lt;/build&gt;
</pre>
<p>...it meant that they were executed like that. The fix is simple, swap the two goals around so you materialize the products before you try to archive them. It makes sense: how can you archive something that doesn't exist yet. The fixed goals block looks like this:</p>
<pre>&lt;!-- Correct goal order --&gt;
&lt;goals&gt;
  &lt;goal&gt;materialize-products&lt;/goal&gt;
  &lt;goal&gt;archive-products&lt;/goal&gt;
&lt;/goals&gt;
</pre>
<p>Hope this works for you too</p>
